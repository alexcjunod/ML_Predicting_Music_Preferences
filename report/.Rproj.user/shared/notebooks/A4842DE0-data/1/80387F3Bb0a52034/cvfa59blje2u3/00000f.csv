"0","spotipy_script <- """
"0","import spotipy"
"0","from spotipy.oauth2 import SpotifyClientCredentials"
"0","import pandas as pd"
"0",""
"0","client_id = '6a91a1da7e484e659532888e8ab5f8e2'"
"0","client_secret = '9e57ca7e029c43caa47f77fe321a8767'"
"0","client_credentials_manager = SpotifyClientCredentials(client_id=client_id, client_secret=client_secret)"
"0","sp = spotipy.Spotify(client_credentials_manager=client_credentials_manager)"
"0",""
"0","# URLs of the playlists"
"0","liked_playlist_link = 'https://open.spotify.com/playlist/5s4m4kmikUzGf4LvX1Lms7'"
"0","disliked_playlist_link = 'https://open.spotify.com/playlist/6cq1EaOcKqxCC0wjOXpAv3' "
"0",""
"0","liked_playlist_URI = liked_playlist_link.split('/')[-1].split('?')[0]"
"0","disliked_playlist_URI = disliked_playlist_link.split('/')[-1].split('?')[0]"
"0",""
"0","def fetch_tracks(playlist_URI, like_label, sp):"
"0","    tracks_data = []"
"0","    results = sp.playlist_tracks(playlist_URI)"
"0","    for item in results['items']:"
"0","        track_details = item['track']"
"0","        track_uri = track_details['uri']"
"0","        track_name = track_details['name']"
"0","        artist_uri = track_details['artists'][0]['uri']"
"0","        artist_info = sp.artist(artist_uri)"
"0","        album_info = sp.album(track_details['album']['uri'])"
"0",""
"0","        audio_features = sp.audio_features(track_uri)[0]"
"0","        audio_analysis = sp.audio_analysis(track_uri)"
"0",""
"0","        avg_segment_duration = sum(seg['duration'] for seg in audio_analysis['segments']) / len(audio_analysis['segments'])"
"0","        avg_segment_loudness = sum(seg['loudness_max'] for seg in audio_analysis['segments']) / len(audio_analysis['segments'])"
"0","        avg_segment_timbre = [sum(seg['timbre'][i] for seg in audio_analysis['segments']) / len(audio_analysis['segments']) for i in range(12)]"
"0","        avg_section_tempo = sum(section['tempo'] for section in audio_analysis['sections']) / len(audio_analysis['sections'])"
"0",""
"0","        if audio_features:"
"0","            track_data = {"
"0","                'Track URI': track_uri,"
"0","                'Track Name': track_name,"
"0","                'Artist URI': artist_uri,"
"0","                'Artist Name': track_details['artists'][0]['name'],"
"0","                'Artist Popularity': artist_info['popularity'],"
"0","                'Artist Genres': ', '.join(artist_info['genres']),"
"0","                'Artist Followers': artist_info['followers']['total'],"
"0","                'Album Name': track_details['album']['name'],"
"0","                'Album Popularity': album_info['popularity'],"
"0","                'Release Date': album_info['release_date'],"
"0","                'Track Popularity': track_details['popularity'],"
"0","                'Explicit': track_details['explicit'],"
"0","                'Danceability': audio_features['danceability'],"
"0","                'Energy': audio_features['energy'],"
"0","                'Key': audio_features['key'],"
"0","                'Loudness': audio_features['loudness'],"
"0","                'Mode': audio_features['mode'],"
"0","                'Speechiness': audio_features['speechiness'],"
"0","                'Acousticness': audio_features['acousticness'],"
"0","                'Instrumentalness': audio_features['instrumentalness'],"
"0","                'Liveness': audio_features['liveness'],"
"0","                'Valence': audio_features['valence'],"
"0","                'Tempo': audio_features['tempo'],"
"0","                'Duration_ms': audio_features['duration_ms'],"
"0","                'Time Signature': audio_features['time_signature'],"
"0","                'Average Segment Duration': avg_segment_duration,"
"0","                'Average Segment Loudness': avg_segment_loudness,"
"0","                'Average Segment Timbre': avg_segment_timbre,"
"0","                'Average Section Tempo': avg_section_tempo,"
"0","                'Liked': like_label"
"0","            }"
"0","            tracks_data.append(track_data)"
"0","    return tracks_data"
"0",""
"0","liked_tracks = fetch_tracks(liked_playlist_URI, 1, sp)"
"0","disliked_tracks = fetch_tracks(disliked_playlist_URI, 0, sp)"
"0","all_tracks = liked_tracks + disliked_tracks"
"0",""
"0","df = pd.DataFrame(all_tracks)"
"0","df.to_csv('spotify_playlist_data_labeled_alex.csv', index=False)"
"0","print(df.head())"
"0",""""
"0",""
"0","# Run the Python script in R"
"0","py_run_string(spotipy_script)"
"1","                              Track URI  ... Liked
0  spotify:track:3fDHHkOEw2Fr8km3T4ixYQ  ...     1
1  spotify:track:5ZK62nSchTamBy8F6HIZov  ...     1
2  spotify:track:5jHilrZDaP1vJMZfdN1He3  ...     1
3  spotify:track:0FMgzGbCh8yNMibGY5L2cM  ...     1
4  spotify:track:75rGONmoi48LLYBFaGiYsv  ...     1

[5 rows x 30 columns]
"
